<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zira Artifacts - Our Products</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="icon" type="image/png" href="{{ url_for('static', filename='images/logo.png') }}">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- jQuery (for popup toggle) -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
<script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
    <!-- Custom Styles -->

<style>
    /* Custom Font */
    body, .navbar {
        font-family: 'Poppins', sans-serif;
    }

    /* Hidden Class for Dropdown */
    .hidden {
        display: none !important;
    }

    /* Image Transition on Hover */
    .product-card img {
        transition: opacity 0.5s ease-in-out;
    }

    /* Wishlist Button and Tooltip */
    .wishlist-btn {
        position: absolute;
        top: 10px;
        right: 10px;
        color: #6b7280;
        transition: color 0.3s ease;
        z-index: 10;
    }
    .wishlist-btn:hover {
        color: #d97706;
    }
    .wishlist-btn.active {
        color: #d97706;
    }
    .wishlist-btn:hover .tooltip {
        visibility: visible;
        opacity: 1;
    }
    .tooltip {
        visibility: hidden;
        opacity: 0;
        position: absolute;
        top: 30px;
        right: -10px;
        background-color: #d97706;
        color: white;
        padding: 6px 10px;
        border-radius: 4px;
        font-size: 0.75rem;
        white-space: nowrap;
        transition: opacity 0.3s ease, visibility 0.3s ease;
        z-index: 15;
    }
    .tooltip::after {
        content: '';
        position: absolute;
        top: 100%;
        right: 15px;
        width: 0;
        height: 0;
        border-left: 5px solid transparent;
        border-right: 5px solid transparent;
        border-top: 5px solid #d97706;
    }

    /* Animations */
    .animate-fadeInUp { animation: fadeInUp 0.8s ease-out forwards; }
    .animate-bounceIn { animation: bounceIn 1s ease-out forwards; }
    .animate-zoomIn { animation: zoomIn 5s ease-out forwards; }
    .animate-pageLoad { animation: pageLoad 1s ease-out forwards; }
    .animate-navLoad { animation: navLoad 0.8s ease-out forwards; }
    .animate-rotateToggle { animation: rotateToggle 0.3s ease-in-out forwards; }
    .animate-bounce { animation: bounce 0.2s ease-in-out; }
    .animate-pulse { animation: pulse 0.3s ease-in-out; }
    @keyframes fadeInUp {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
    }
    @keyframes bounceIn {
        0% { opacity: 0; transform: scale(0.95); }
        50% { opacity: 0.5; transform: scale(1.05); }
        100% { opacity: 1; transform: scale(1); }
    }
    @keyframes zoomIn {
        from { background-size: 100%; }
        to { background-size: 110%; }
    }
    @keyframes pageLoad {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
    }
    @keyframes navLoad {
        from { opacity: 0; transform: translateY(-20px); }
        to { opacity: 1; transform: translateY(0); }
    }
    @keyframes rotateToggle {
        0% { transform: rotate(0deg) scale(1); }
        50% { transform: rotate(90deg) scale(1.2); }
        100% { transform: rotate(180deg) scale(1); }
    }
    @keyframes bounce {
        0% { transform: scale(1); }
        50% { transform: scale(1.3); }
        100% { transform: scale(1); }
    }
    @keyframes pulse {
        0% { transform: scale(1); opacity: 1; }
        50% { transform: scale(1.1); opacity: 0.8; }
        100% { transform: scale(1); opacity: 1; }
    }

    /* Delay Classes */
    .delay-\[100ms\] { animation-delay: 100ms; }
    .delay-\[200ms\] { animation-delay: 200ms; }
    .delay-\[300ms\] { animation-delay: 300ms; }
    .delay-\[400ms\] { animation-delay: 400ms; }

    /* Navbar Styling */
    .navbar {
        background: #ffffff;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        padding: 1rem 0;
        position: fixed;
        width: 100%;
        z-index: 50;
        animation: navLoad 0.8s ease-out;
    }
    .navbar-item {
        position: relative;
        font-size: 1.2rem;
        font-weight: 500;
        color: #4b5563;
        padding: 0.75rem 1.5rem;
        transition: all 0.3s ease;
        border-radius: 8px;
    }
    .navbar-item:hover, .navbar-item.active {
        color: #1f2937;
        transform: scale(1.05);
        background-color: rgba(0, 0, 0, 0.05);
    }
    .navbar-item::after {
        content: '';
        position: absolute;
        bottom: 0;
        left: 50%;
        transform: translateX(-50%);
        width: 0;
        height: 3px;
        background-color: #1f2937;
        transition: width 0.3s ease;
    }
    .navbar-item:hover::after, .navbar-item.active::after {
        width: 50%;
    }
    .nav-hover:hover {
        transform: scale(1.05);
    }

    /* Search Container */
    .search-container {
        position: relative;
    }
    .search-container input {
        border: 1px solid #d1d5db;
        border-radius: 0.375rem;
        padding: 0.5rem 2.5rem 0.5rem 0.75rem;
        outline: none;
    }
    .search-container .fa-search {
        position: absolute;
        right: 0.75rem;
        top: 50%;
        transform: translateY(-50%);
        color: #6b7280;
    }
    #mobile-search-bar {
        display: none;
        position: absolute;
        top: 3rem;
        left: 0;
        right: 0;
        margin: 0 1rem;
        z-index: 45;
    }
    #mobile-search-bar.active {
        display: block;
    }

    /* Sidebar Filter Hover Effects */
    .filter-item:hover, .sidebar select:hover {
        transform: scale(1.05);
        color: #d97706;
        transition: transform 0.3s ease, color 0.3s ease;
    }

    /* Responsive Grid for Product Cards */
    .product-grid.cols-2 { grid-template-columns: repeat(2, 1fr); }
    .product-grid.cols-3 { grid-template-columns: repeat(3, 1fr); }
    .product-grid.cols-4 { grid-template-columns: repeat(4, 1fr); }
    .product-grid.cols-5 { grid-template-columns: repeat(5, 1fr); }
    .product-grid.list-view {
        grid-template-columns: 1fr;
        gap: 1rem;
    }
    .product-grid.list-view .product-card {
        display: flex;
        flex-direction: row;
        align-items: center;
        gap: 1rem;
    }
    .product-grid.list-view .product-card .relative {
        width: 150px;
        height: 150px;
    }
    .product-grid.list-view .product-card .p-4 {
        flex: 1;
        text-align: left;
    }

    /* Display Option Icons */
    .display-option {
        padding: 0.5rem;
        cursor: pointer;
        color: #4b5563;
        transition: color 0.3s ease;
    }
    .display-option:hover, .display-option.active {
        color: #d97706;
    }

    /* Floating Filter Toggler Button (Mobile) */
    .filter-toggler {
        display: none;
        position: fixed;
        top: 100px;
        left: 16px;
        background-color: #d97706;
        color: white;
        padding: 8px;
        border-radius: 50%;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        z-index: 40;
        transition: background-color 0.3s ease;
    }
    .filter-toggler:hover {
        background-color: #b45309;
    }

    /* Filter Close Button (Mobile) */
    #filter-close-btn {
        display: none;
        background-color: #d97706;
        color: white;
        padding: 8px;
        border-radius: 50%;
        transition: background-color 0.3s ease;
    }
    #filter-close-btn:hover {
        background-color: #b45309;
    }

    /* Country Button in Navbar */
    #mobile-country-btn-container,
    #desktop-country-btn-container {
        position: relative;
        display: flex;
        flex-direction: column;
        align-items: center;
        z-index: 60;
        overflow: visible;
    }
    #mobile-country-btn,
    #desktop-country-btn {
        background-color:#d97706;
        color: #374151;
        padding: 0.25rem 0.75rem;
        border-radius: 9999px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        transition: background-color 0.2s;
        display: flex;
        align-items: center;
        font-size: 0.875rem;
        cursor: pointer;
    }
    #mobile-country-btn:hover,
    #desktop-country-btn:hover {
        background-color: #f3f4f6;
    }
    #mobile-country-btn .flag,
    #desktop-country-btn .flag {
        font-size: 0.875rem;
        margin-right: 0.5rem;
    }
    #mobile-country-dropdown,
    #desktop-country-dropdown {
        position: absolute;
        top: 100%;
        right: 0;
        margin-top: 0.5rem;
        width: 8rem;
        background-color: white;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        border-radius: 0.375rem;
        padding: 1rem;
        z-index: 80;
        display: none;
    }
    #mobile-country-dropdown:not(.hidden),
    #desktop-country-dropdown:not(.hidden) {
        display: block;
    }
    .country-option {
        font-size: 0.875rem;
        color: #4b5563;
        padding: 0.25rem 0.5rem;
        transition: color 0.3s ease;
        cursor: pointer;
    }
    .country-option:hover {
        color: #d97706;
    }
    .floating-text {
        font-size: 0.75rem;
        color: #4b5563;
        margin-bottom: 0.25rem;
        white-space: nowrap;
        text-align: center;
    }

    /* Action Button Hover Effect */
    .action-btn {
        transition: background-color 0.3s ease, transform 0.3s ease;
    }
    .action-btn:hover {
        transform: scale(1.05);
    }

    /* Search Bar Styling */
    .search-input:focus {
        border-color: #d97706;
        box-shadow: 0 0 0 3px rgba(217, 119, 6, 0.2);
    }

    /* No Results Message */
    .no-results {
        display: none;
        text-align: center;
        color: #4b5563;
        font-size: 1rem;
        grid-column: 1 / -1;
    }

    /* Mobile Sidebar Styling */
    .mobile-sidebar-item {
        display: block;
        padding: 0.75rem 1rem;
        font-size: 1.1rem;
        font-weight: 500;
        color: #4b5563;
        transition: color 0.3s ease, background-color 0.3s ease;
    }
    .mobile-sidebar-item:hover, .mobile-sidebar-item.active {
        color: #d97706;
        background-color: #f3f4f6;
    }

    /* Quantity Modal */
    #quantity-modal {
        transition: opacity 0.3s ease;
    }
    #quantity-modal.hidden {
        opacity: 0;
        pointer-events: none;
    }
    #quantity-modal:not(.hidden) {
        opacity: 1;
    }
    #quantity-input {
        appearance: textfield;
    }
    #quantity-input::-webkit-outer-spin-button,
    #quantity-input::-webkit-inner-spin-button {
        -webkit-appearance: none;
        margin: 0;
    }

    /* Floating Button Styles */
    :root {
        --whatsapp-green: #25D366;
        --pink: #EC4899;
        --yellow-600: #d97706;
        --yellow-700: #b45309;
        --red: #EF4444;
        --error-red: #dc2626;
    }

    /* Custom Animations */
    @keyframes bounce {
        0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
        40% { transform: translateY(-15px); }
        60% { transform: translateY(-7px); }
    }

    /* Floating Button Container */
    .floating-btn-container {
        position: fixed;
        z-index: 1000;
        display: flex;
        align-items: center;
        pointer-events: auto;
    }

    /* WhatsApp Button */
    .whatsapp-btn-container {
        bottom: 16px;
        right: 16px;
    }
    .whatsapp-btn-container .floating-btn {
        width: 48px;
        height: 48px;
        background-color: var(--whatsapp-green);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        transition: all 0.3s ease;
        animation: bounce 2s infinite;
        cursor: pointer;
    }
    .whatsapp-btn-container .floating-btn i {
        color: white;
        font-size: 24px;
    }
    .whatsapp-btn-container .floating-btn:hover {
        transform: scale(1.1);
    }
    .whatsapp-btn-container .floating-text {
        margin-right: 8px;
        background-color: rgba(0, 0, 0, 0.7);
        color: white;
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 12px;
        white-space: nowrap;
    }
    .whatsapp-btn-container .badge {
        position: absolute;
        top: -4px;
        right: -4px;
        background-color: var(--red);
        color: white;
        border-radius: 50%;
        padding: 2px 6px;
        font-size: 10px;
    }

    /* Discount Button (About Zira Collection) */
    .discount-btn-container {
        bottom: 16px;
        left: 16px;
        position: fixed;
        z-index: 1000;
        pointer-events: auto;
    }
    .discount-btn-container .floating-btn {
        background-color: var(--pink);
        border-radius: 9999px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 12px;
        color: white;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        padding: 16px;
        height: 48px;
        transition: all 0.3s ease;
        animation: bounce 2s infinite;
        cursor: pointer;
    }
    .discount-btn-container .floating-btn:hover {
        transform: scale(1.1);
    }
    .discount-btn-container .floating-btn img {
        width: 24px;
        height: 24px;
        margin-right: 8px;
    }

    /* Discount Popup */
    #discount-page {
        z-index: 60;
        overflow-y: auto;
        -webkit-overflow-scrolling: touch;
        transition: transform 0.5s ease-in-out;
    }
    #discount-page .p-6 {
        min-height: 100%;
        box-sizing: border-box;
    }
    #close-discount {
        position: absolute;
        top: 1rem;
        right: 1rem;
        z-index: 65;
    }

    /* Email Form Styling */
    #contact-form {
        display: flex;
        flex-direction: column;
        gap: 1.25rem;
    }
    #contact-form label {
        font-weight: 500;
        color: #374151;
    }
    #contact-form input,
    #contact-form textarea {
        background: #ffffff;
        border: 1px solid #d1d5db;
        border-radius: 0.375rem;
        padding: 0.75rem;
        font-size: 0.875rem;
        color: #1f2937;
        transition: border-color 0.2s ease, box-shadow 0.2s ease;
    }
    #contact-form input:focus,
    #contact-form textarea:focus {
        border-color: var(--yellow-600);
        box-shadow: 0 0 0 3px rgba(217, 119, 6, 0.2);
    }
    #contact-form textarea {
        resize: vertical;
        min-height: 120px;
    }
    #contact-form button {
        background: var(--yellow-600);
        color: #ffffff;
        font-weight: 600;
        padding: 0.75rem 1.5rem;
        border-radius: 0.375rem;
        border: none;
        cursor: pointer;
        transition: background-color 0.2s ease, transform 0.2s ease, box-shadow 0.2s ease;
    }
    #contact-form button:hover {
        background: var(--yellow-700);
        transform: translateY(-2px);
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
    #contact-form button:focus {
        box-shadow: 0 0 0 3px rgba(217, 119, 6, 0.3);
    }
    #contact-form .text-right {
        text-align: center;
    }

    /* Flash Messages */
    #flash-message1 {
        position: fixed;
        top: 20px;
        left: 50%;
        transform: translateX(-50%);
        padding: 16px;
        border-radius: 8px;
        color: white;
        font-size: 16px;
        z-index: 9999;
        opacity: 0;
        transition: opacity 0.5s ease-in-out;
        min-width: 200px;
        text-align: center;
    }
    #flash-message1.success {
        background-color: var(--yellow-600);
    }
    #flash-message1.error {
        background-color: var(--error-red);
    }
    #flash-message1.show {
        opacity: 1;
    }

    /* Product Details Modal */
    #product-details-modal {
        transition: opacity 0.3s ease;
    }
    #product-details-modal.hidden {
        opacity: 0;
        pointer-events: none;
    }
    #product-details-modal:not(.hidden) {
        opacity: 1;
    }
    #product-details-modal .bg-white {
        animation: fadeInUp 0.3s ease-out;
    }
    #product-details-modal img {
        width: 100%;
        height: auto;
        max-height: 400px;
        object-fit: contain;
        transition: none;
    }
    #product-details-modal img:hover {
        transform: scale(1.05);
    }
    #product-details-modal button {
        transition: background-color 0.3s ease, transform 0.3s ease;
    }
    #product-details-modal button:hover {
        transform: scale(1.05);
    }

    /* Responsive Adjustments */
    @media (max-width: 767px) {
        #desktop-navbar {
            display: none !important;
        }
        .product-grid.cols-2 {
            grid-template-columns: repeat(2, 1fr);
        }
        .product-grid.cols-3, .product-grid.cols-4, .product-grid.cols-5 {
            grid-template-columns: 1fr;
        }
        .product-grid.list-view .product-card {
            flex-direction: column;
            align-items: center;
            text-align: center;
        }
        .product-grid.list-view .product-card .relative {
            width: 100%;
            height: 200px;
        }
        .product-grid.list-view .product-card .p-4 {
            text-align: center;
        }
        .sidebar {
            position: fixed;
            top: 0;
            left: 0;
            width: 280px;
            height: 100%;
            background-color: #f3f4f6;
            transform: translateX(-100%);
            transition: transform 0.3s ease;
            z-index: 60;
            overflow-y: auto;
        }
        .sidebar.open {
            transform: translateX(0);
        }
        #mobile-sidebar {
        display: block; /* Ensure it's not hidden */
        transform: translateX(-100%);
        transition: transform 0.3s ease;
         z-index: 80; /* Increase z-index */
    }
    #mobile-sidebar.open {
        transform: translateX(0);
    }

        .filter-toggler {
            display: block;
        }
        #filter-close-btn {
            display: block;
        }
        .tooltip {
            right: 0;
            top: -50px;
        }
        .tooltip::after {
            right: 10px;
        }
        .navbar {
            padding: 0.5rem 0;
        }
        .navbar-logo {
            height: 48px;
        }
        .whatsapp-btn-container .floating-btn {
            width: 36px;
            height: 36px;
        }
        .whatsapp-btn-container .floating-btn i {
            font-size: 18px;
        }
        .whatsapp-btn-container .floating-text {
            font-size: 10px;
            padding: 3px 6px;
        }
        .whatsapp-btn-container .badge {
            font-size: 8px;
            padding: 1px 4px;
            top: -2px;
            right: -2px;
        }
        .discount-btn-container .floating-btn {
            height: 36px;
            font-size: 10px;
            padding: 12px;
        }
        .discount-btn-container .floating-btn img {
            width: 18px;
            height: 18px;
            margin-right: 6px;
        }
        #discount-page {
            width: 100%;
        }
        #discount-page .p-6 {
            padding: 1rem;
        }
        #discount-page .h-16 {
            height: 2.5rem;
        }
        #discount-page h2 {
            font-size: 1.5rem;
        }
        #discount-page p {
            font-size: 0.875rem;
        }
        #discount-page .text-sm {
            font-size: 0.75rem;
        }
        #contact-form {
            gap: 1rem;
        }
        #contact-form input,
        #contact-form textarea {
            font-size: 0.875rem;
            padding: 0.5rem;
        }
        #contact-form button {
            font-size: 0.875rem;
            padding: 0.5rem 1rem;
        }
        #contact-form label {
            font-size: 0.75rem;
        }
        #mobile-country-btn-container {
            display: flex;
        }
        #mobile-country-btn {
            padding: 0.25rem 0.5rem;
            font-size: 0.75rem;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        }
        #mobile-country-btn .flag {
            font-size: 0.75rem;
        }
        #mobile-country-dropdown {
            width: 100px;
            padding: 0.5rem;
        }
        .country-option {
            font-size: 0.75rem;
        }
        .floating-text {
            font-size: 0.625rem;
            margin-bottom: 0.125rem;
        }
    }
    @media (min-width: 768px) {
        #desktop-navbar {
            display: flex !important;
            visibility: visible !important;
            opacity: 1 !important;
        }
        .product-grid.cols-3, .product-grid.cols-4, .product-grid.cols-5 {
            grid-template-columns: repeat(2, 1fr);
        }
        .sidebar {
            width: 100%;
            margin-bottom: 2rem;
        }
        .navbar-item {
            padding: 0.5rem 0.75rem;
            font-size: 1rem;
        }
        .navbar-logo {
            height: 56px;
        }
        #discount-page {
            width: 50%;
        }
        #desktop-country-btn-container {
            display: flex;
        }
        #desktop-country-btn {
            padding: 0.375rem 0.75rem;
            font-size: 0.875rem;
        }
        #desktop-country-dropdown {
            width: 120px;
            padding: 0.75rem;
        }
        .country-option {
            font-size: 0.875rem;
        }
        .floating-text {
            font-size: 0.75rem;
        }
        #mobile-sidebar {
            display: none;
        }
    }
    @media (min-width: 1024px) {
        .product-grid.cols-3 { grid-template-columns: repeat(3, 1fr); }
        .navbar-logo {
            height: 64px;
        }
        #desktop-country-btn {
            padding: 0.5rem 1rem;
            font-size: 0.875rem;
        }
        #desktop-country-dropdown {
            width: 140px;
            padding: 1rem;
        }
        .country-option {
            font-size: 0.875rem;
        }
        .floating-text {
            font-size: 0.75rem;
        }
    }

    #close-product-modal {
    position: absolute !important;
    top: 1rem !important;
    right: 1rem !important;
    z-index: 100 !important; /* Ensures it's above all modal content */
    cursor: pointer !important;
    background: none !important;
    border: none !important;
    padding: 0.5rem !important;
    color: #4b5563 !important; /* Tailwind text-gray-600 */
    transition: color 0.3s ease !important;
    outline: none !important;
    pointer-events: auto !important;
}

#close-product-modal:hover {
    color: #dc2626 !important; /* Tailwind text-red-600 */
}

#close-product-modal:focus {
    box-shadow: 0 0 0 3px rgba(217, 119, 6, 0.3) !important; /* Tailwind focus:ring-yellow-600 */
}

#close-product-modal i {
    font-size: 1.25rem !important; /* Tailwind text-xl */
    line-height: 1 !important; /* Ensure proper alignment */
}

</style>
</head>
<body class="bg-gray-50 font-sans">
    <!-- Navbar -->
    <!-- Navbar -->
<nav class="navbar bg-white shadow-md fixed w-full z-50">
    <div class="container mx-auto px-4 py-3 flex items-center justify-between">
        <!-- Mobile Navbar -->
        <div class="md:hidden flex items-center justify-between w-full relative">
            <button id="nav-toggler" class="text-2xl"><i class="fas fa-bars"></i></button>
            <img loading="lazy" src="{{ url_for('static', filename='images/logo.png') }}" alt="Zira Artifacts Logo" class="h-12 navbar-logo">
            <div class="flex items-center space-x-4">
                <i id="mobile-search-icon" class="fas fa-search text-gray-700 hover:text-gray-900 cursor-pointer"></i>
                <a href="{{ url_for('account') }}" class="fas fa-shopping-cart text-gray-700 hover:text-gray-900"></a>
                <div id="mobile-country-btn-container" class="relative flex flex-col items-center">
                    <span class="floating-text text-xs text-gray-700 mb-1">Currency</span>
                    <button id="mobile-country-btn" class="bg-white text-gray-700 px-3 py-1 rounded-full shadow-md hover:bg-gray-100 transition flex items-center text-sm">
                        <span class="flag">🇺🇸</span> USA
                    </button>
                    <div id="mobile-country-dropdown" class="hidden absolute bg-white shadow-md rounded-md p-4 w-32 top-full mt-2 right-0 z-80">
                        <div class="country-option" data-country="USA" data-currency="USD" data-flag="🇺🇸">USA (USD)</div>
                        <div class="country-option" data-country="Germany" data-currency="EUR" data-flag="🇩🇪">Germany (EUR)</div>
                        <div class="country-option" data-country="UK" data-currency="GBP" data-flag="🇬🇧">UK (GBP)</div>
                        <div class="country-option" data-country="Kenya" data-currency="KES" data-flag="🇰🇪">Kenya (KES)</div>
                    </div>
                </div>
            </div>
            <div id="mobile-search-bar" class="bg-white shadow-md rounded px-3 py-1 hidden">
                <input type="text" placeholder="Search artifacts & cultural items" class="w-full outline-none text-gray-700 search-input">
            </div>
        </div>
        <!-- Desktop Navbar -->
        <div id="desktop-navbar" class="hidden md:flex items-center justify-between w-full">
            <img loading="lazy" src="{{ url_for('static', filename='images/logo.png') }}" alt="Zira Artifacts Logo" class="h-12 navbar-logo">
            <div class="flex space-x-6">
                <div class="relative nav-hover">
                    <a href="{{ url_for('index') }}" class="navbar-item text-gray-700">Home</a>
                </div>
                <div class="relative nav-hover">
                    <a href="{{ url_for('our_products') }}" class="navbar-item text-gray-700 active">Products</a>
                </div>
                <div class="relative nav-hover">
                    <a href="{{ url_for('discounted_artefacts') }}" class="navbar-item text-gray-700">Special Discount</a>
                </div>
            </div>
            <div class="flex items-center space-x-4">
                <div class="search-container">
                    <input type="text" placeholder="Search artifacts & cultural items" class="border rounded px-3 py-1 search-input">
                    <i class="fas fa-search"></i>
                </div>
                <a href="{{ url_for('account') }}" class="fas fa-heart text-gray-700 hover:text-gray-900"></a>
                <a href="{{ url_for('account') }}" class="fas fa-shopping-cart text-gray-700 hover:text-gray-900"></a>
                <div id="desktop-country-btn-container" class="relative flex flex-col items-center">
                    <span class="floating-text text-xs text-gray-700 mb-1">Currency</span>
                    <button id="desktop-country-btn" class="bg-white text-gray-700 px-3 py-1 rounded-full shadow-md hover:bg-gray-100 transition flex items-center text-sm">
                        <span class="flag">🇺🇸</span> USA
                    </button>
                    <div id="desktop-country-dropdown" class="hidden absolute bg-white shadow-md rounded-md p-4 w-32 top-full mt-2 right-0 z-80">
                        <div class="country-option" data-country="USA" data-currency="USD" data-flag="🇺🇸">USA (USD)</div>
                        <div class="country-option" data-country="Germany" data-currency="EUR" data-flag="🇩🇪">Germany (EUR)</div>
                        <div class="country-option" data-country="UK" data-currency="GBP" data-flag="🇬🇧">UK (GBP)</div>
                        <div class="country-option" data-country="Kenya" data-currency="KES" data-flag="🇰🇪">Kenya (KES)</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</nav>
<!-- Mobile Sidebar -->
<div id="mobile-sidebar" class="fixed top-0 left-0 w-64 h-full bg-gray-100 transform translate-x-[-100%] transition-transform duration-300 z-60">
    <button id="close-sidebar" class="absolute top-4 right-4 text-2xl text-gray-700"><i class="fas fa-times"></i></button>
    <div class="flex flex-col p-4 space-y-4">
        <a href="{{ url_for('index') }}" class="mobile-sidebar-item text-gray-700 hover:text-yellow-600" style="margin-top: 100px;">Home</a>
        <a href="{{ url_for('our_products') }}" class="mobile-sidebar-item text-gray-700 hover:text-yellow-600 active">Products</a>
        <a href="{{ url_for('discounted_artefacts') }}" class="mobile-sidebar-item text-gray-700 hover:text-yellow-600">Special Discount</a>
        <a href="{{ url_for('account') }}" class="mobile-sidebar-item text-gray-700 hover:text-yellow-600">Account</a>
    </div>
</div>

    <!-- Hero Section -->
    <section class="relative h-96">
        <div class="absolute inset-0 bg-cover bg-center animate-zoomIn" style="background-image: url('{{ url_for('static', filename='images/pot7.jpg') }}');">
            <div class="container mx-auto h-full flex items-center px-4">
                <div class="bg-white bg-opacity-80 p-6 rounded animate-fadeInUp">
                    <h1 class="text-4xl font-bold text-yellow-600">Our Fair Price Products</h1>
                    <p class="mt-2 text-gray-800">Discover Our Premium Artifacts at Original Prices</p>
                </div>
            </div>
        </div>
    </section>

    <!-- WhatsApp Floating Button -->
<div class="floating-btn-container whatsapp-btn-container">
    <span class="floating-text">Chat with Us</span>
    <a href="https://wa.me/254701539003" target="_blank" aria-label="Chat with us on WhatsApp">
        <div class="floating-btn relative" role="button">
            <i class="fab fa-whatsapp"></i>
            <span class="badge">1</span>
        </div>
    </a>
</div>


    <!-- Discount Floating Button -->
    <div class="floating-btn-container discount-btn-container" id="discount-btn" aria-controls="discount-page">
        <div class="floating-btn" role="button" aria-label="Open About Zira Collection">
            <img loading="lazy" src="{{ url_for('static', filename='images/logo.png') }}" alt="Zira Collection Logo">
            <span>About Zira Collection</span>
        </div>
    </div>

    <!-- Discount Popup -->
<div id="discount-page" class="fixed inset-y-0 left-0 bg-white shadow-lg transform -translate-x-full transition-transform z-30 md:w-1/2 w-full">
    <div class="p-6 space-y-6">
        <!-- Close Button -->
        <div class="flex justify-end">
            <button id="close-discount" class="text-gray-600 text-2xl hover:text-red-600 transition">
                <i class="fas fa-times"></i>
            </button>
        </div>

        <!-- Logo -->
        <div class="flex justify-center">
            <img loading="lazy" src="{{ url_for('static', filename='images/logo.png') }}" alt="Zira Collection Logo" class="h-16 w-auto">
        </div>

        <!-- About Text -->
        <div class="text-center">
            <h2 class="text-3xl font-extrabold text-gray-800 mb-4">About Zira Collection</h2>
            <p class="text-gray-600 text-base leading-relaxed">
                At <span class="font-semibold text-yellow-600">Zira Collection</span>, we offer a curated celebration of Africa’s rich artistic heritage — showcasing 
                <span class="italic">handcrafted artefacts</span>, <span class="italic">intricate beadwork</span>, 
                <span class="italic">elegant soapstone carvings</span>, <span class="italic">beautifully done wooden products</span>, and 
                <span class="italic">vibrant woven rugs</span>. Each piece is <span class="font-medium text-gray-800">authentically made</span> by 
                <span class="font-medium text-gray-800">skilled African artisans</span>, blending traditional techniques with contemporary design.
                Whether you're looking for <span class="font-semibold">meaningful souvenirs</span>, <span class="font-semibold">distinctive home décor</span>, 
                or <span class="font-semibold">wearable cultural regalia</span>, our collection offers <span class="italic">timeless treasures that tell a story</span>.
                By supporting this initiative, you’re not only bringing <span class="text-yellow-700 font-semibold">beauty into your space</span> but also 
                <span class="text-yellow-700 font-semibold">empowering local communities</span> across the continent.
            </p>
        </div>

        <!-- Contact Info -->
        <div class="bg-gray-100 p-4 rounded-lg shadow-inner text-gray-700">
            <h3 class="text-xl font-semibold mb-2 text-yellow-700">Contact Us</h3>
            <ul class="space-y-1 text-sm">
                <li><strong>Phone:</strong> <a href="tel:+254701539003">0701 539003</a></li>
                <li><strong>Email:</strong> <a href="mailto:vickiebmochama@gmail.com">vickiebmochama@gmail.com</a></li>
                <li><strong>Location:</strong> Nairobi, Kenya</li>
            </ul>
        </div>

        <!-- Email Form -->
        <div class="bg-gray-100 p-4 rounded-lg shadow-inner text-gray-700">
            <h3 class="text-xl font-semibold mb-4 text-yellow-700">Send Us a Message</h3>
            <div id="flash-message1" style="display: none;"></div>
            <form id="contact-form" class="space-y-4">
                <div>
                    <label for="contact-subject" class="block text-sm font-medium text-gray-700">Subject</label>
                    <input type="text" id="contact-subject" name="subject" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yellow-600 transition" required>
                </div>
                <div>
                    <label for="contact-message" class="block text-sm font-medium text-gray-700">Message</label>
                    <textarea id="contact-message" name="message" rows="4" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yellow-600 transition" required></textarea>
                </div>
                <div class="text-right">
                    <button type="submit" class="px-4 py-2 bg-yellow-600 text-white rounded-md hover:bg-yellow-700 focus:outline-none focus:ring-2 focus:ring-yellow-600 transition">Send Message</button>
                </div>
            </form>
        </div>
    </div>
</div>

    <!-- Products Section -->
    <section id="products-section" class="bg-white py-16 animate-pageLoad">
        <div class="max-w-7xl mx-auto px-4 relative">
            <!-- Floating Filter Toggler Button (Mobile) -->
            <button id="filter-toggler" class="filter-toggler">
                <i class="fas fa-filter"></i>
            </button>

            <!-- Header and Display Options -->
            <div class="flex flex-col md:flex-row justify-between items-center mb-12">
                <h2 class="text-3xl font-semibold text-yellow-600 animate-fadeInUp">Our Artifacts</h2>
                <div class="display-options flex gap-2 mt-4 md:mt-0">
                    <i class="fas fa-th display-option cols-2" data-cols="2" title="2 Columns"></i>
                    <i class="fas fa-th-large display-option cols-3 active" data-cols="3" title="3 Columns"></i>
                    <i class="fas fa-th display-option cols-4" data-cols="4" title="4 Columns"></i>
                    <i class="fas fa-th display-option cols-5" data-cols="5" title="5 Columns"></i>
                    <i class="fas fa-list display-option list-view" data-view="list" title="List View"></i>
                </div>
            </div>

            <!-- Main Content with Sidebar -->
            <div class="flex flex-col md:flex-row gap-8">
                <!-- Left Sidebar with Filters -->
                <div class="sidebar w-full md:w-64 bg-gray-100 p-6 rounded-lg shadow-md">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-semibold text-yellow-600">Filters</h3>
                        <button id="filter-close-btn">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <!-- Category Filter -->
                    <div class="mb-6">
                        <label class="text-gray-700 font-medium mb-2 block">Category</label>
                        <div class="space-y-2">
                            <a href="#" class="block py-1 text-gray-700 filter-item" data-filter="all">All Categories</a>
                            {% for category in categories %}
                            <a href="#" class="block py-1 text-gray-700 filter-item" data-filter="{{ category.name }}">{{ category.name }}</a>
                            {% endfor %}
                        </div>
                    </div>
                    <!-- Price Range Filter -->
                    <div>
                        <label class="text-gray-700 font-medium mb-2 block">Price Range</label>
                        <select class="w-full p-2 border rounded-md focus:outline-none price-filter">
                            <option value="all">All Prices</option>
                            <option value="0-100">{{ current_currency }} 0 - 100</option>
                            <option value="100-200">{{ current_currency }} 100 - 200</option>
                            <option value="200+">{{ current_currency }} 200+</option>
                        </select>
                    </div>
                </div>

                <!-- Product Cards -->
                <div class="product-grid grid gap-8 flex-1 cols-3" id="product-grid">
                   {% for product in products %}
<div class="group bg-white shadow-lg rounded-lg overflow-hidden transform transition duration-500 hover:scale-105 animate-bounceIn delay-[{{ loop.index0 * 100 }}ms] product-card" 
     data-product-id="{{ product.id }}"
     data-category="{{ product.category }}" 
     data-name="{{ product.name | lower }}" 
     data-description="{{ product.description | e }}">
    <div class="relative w-full h-64 overflow-hidden cursor-pointer product-image">
        <img loading="lazy" src="{{ url_for('static', filename='uploads/' + product.image) | default('https://via.placeholder.com/300x200') }}" 
             alt="{{ product.name }}" 
             class="w-full h-full object-cover transition-opacity duration-500 group-hover:opacity-0 absolute top-0 left-0">
        <img loading="lazy" src="{{ url_for('static', filename='uploads/' + product.image) | default('https://via.placeholder.com/300x200') }}" 
             alt="{{ product.name }} Hover" 
             class="w-full h-full object-cover transition-opacity duration-500 opacity-0 group-hover:opacity-100 absolute top-0 left-0">
        <!-- Wishlist Button -->
        <button class="wishlist-btn" onclick="event.stopPropagation(); addToWishlist({{ product.id }})">
            <i class="far fa-heart"></i>
            <span class="tooltip">Add to Wishlist</span>
        </button>
    </div>
    <div class="p-4">
        <h3 class="text-lg font-medium text-center text-gray-800 group-hover:text-yellow-600 transition duration-300 border-b-2 border-transparent group-hover:border-yellow-600 inline-block cursor-pointer product-name">
            {{ product.name }}
        </h3>
        <p class="text-center text-gray-600 text-sm mt-2">{{ product.category }}</p>
        <p class="text-center text-gray-600 mt-2 price" data-price="{{ product.price }}">
            {{ current_currency }} {{ product.price | round(2) }}
        </p>
        <div class="flex justify-center gap-2 mt-4">
            <button class="action-btn bg-blue-600 text-white px-3 py-1 rounded hover:bg-blue-700 transition flex items-center" 
                    onclick="event.stopPropagation(); addToCart({{ product.id }})">
                <i class="fas fa-cart-plus mr-2"></i> Add to Cart
            </button>
        </div>
    </div>
</div>
{% else %}
<p class="no-results text-gray-600 col-span-full text-center">No full price products available.</p>
{% endfor %}
                <p class="no-results text-gray-600 col-span-full text-center" id="no-search-results">No matching products found.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Floating Country Button -->
    <div id="country-btn-container" style="display: none !important;">
        <button id="country-btn" class="bg-yellow-600 text-white px-4 py-2 rounded-full shadow-lg hover:bg-yellow-700 transition flex items-center">
            <span class="flag">🇺🇸</span> USA
        </button>
        <div id="country-dropdown" class="hidden absolute bg-white shadow-md rounded-md p-4 w-32">
            <a href="#" class="block py-1 hover:text-gray-900 country-option" data-country="USA" data-currency="USD" data-flag="🇺🇸"><span class="text-sm mr-2">🇺🇸</span>USA</a>
            <a href="#" class="block py-1 hover:text-gray-900 country-option" data-country="Germany" data-currency="EUR" data-flag="🇩🇪"><span class="text-sm mr-2">🇩🇪</span>Germany</a>
            <a href="#" class="block py-1 hover:text-gray-900 country-option" data-country="UK" data-currency="GBP" data-flag="🇬🇧"><span class="text-sm mr-2">🇬🇧</span>UK</a>
            <a href="#" class="block py-1 hover:text-gray-900 country-option" data-country="Kenya" data-currency="KES" data-flag="🇰🇪"><span class="text-sm mr-2">🇰🇪</span>Kenya</a>
        </div>
    </div>

    <!-- Quantity Popup Modal -->
    <div id="quantity-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white p-6 rounded-lg shadow-lg max-w-sm w-full">
            <h3 class="text-lg font-semibold text-gray-800 mb-4">Select Quantity</h3>
            <input type="number" id="quantity-input" min="1" value="1" class="w-full p-2 border rounded-md mb-4 focus:outline-none focus:ring-2 focus:ring-yellow-600">
            <div class="flex justify-end gap-2">
                <button id="cancel-quantity" class="px-4 py-2 bg-gray-300 text-gray-800 rounded hover:bg-gray-400 transition">Cancel</button>
                <button id="confirm-quantity" class="px-4 py-2 bg-yellow-600 text-white rounded hover:bg-yellow-700 transition">Add to Cart</button>
            </div>
        </div>
    </div>
    
<!-- Product Details Modal -->
<div id="product-details-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="bg-white p-6 rounded-lg shadow-lg max-w-lg w-full max-h-[90vh] overflow-y-auto relative">
        <button id="close-product-modal" class="absolute top-4 right-4 text-gray-600 hover:text-red-600 transition">
            <i class="fas fa-times text-xl"></i>
        </button>
        <div id="modal-content" class="space-y-4">
            <img id="modal-image" src="" alt="Product Image" class="w-full h-64 object-cover rounded-md">
            <h3 id="modal-name" class="text-2xl font-semibold text-gray-800"></h3>
            <p id="modal-category" class="text-gray-600"></p>
            <p id="modal-price" class="text-gray-800 font-medium"></p>
            <p id="modal-description" class="text-gray-600"></p>
            <div class="flex justify-end gap-2">
                <button id="modal-add-to-cart" class="px-4 py-2 bg-yellow-600 text-white rounded hover:bg-yellow-700 transition flex items-center">
                    <i class="fas fa-cart-plus mr-2"></i> Add to Cart
                </button>
            </div>
        </div>
    </div>
</div>
    <!-- Footer -->
    <footer class="bg-black text-white py-12 px-6">
        <div class="max-w-7xl mx-auto">
            <!-- Desktop Layout -->
            <div class="hidden md:grid grid-cols-5 gap-8 text-sm">
                <!-- Shop -->
                <div>
                    <h3 class="text-yellow-600 font-semibold mb-3">Shop</h3>
                    <ul class="space-y-2">
                        <li><a href="{{ url_for('our_products') }}" class="text-white hover:text-yellow-400">Artifact Collections</a></li>
                        <li><a href="{{ url_for('account') }}" class="text-white hover:text-yellow-400">Track My Order</a></li>
                    </ul>
                </div>
                <!-- Sell -->
                <div>
                    <h3 class="text-yellow-600 font-semibold mb-3">Sell</h3>
                    <ul class="space-y-2">
                        <li><a href="#" class="text-white hover:text-yellow-400">Sell on Zira Artifacts</a></li>
                        <li><a href="#" class="text-white hover:text-yellow-400">Artisan Seller FAQ</a></li>
                    </ul>
                </div>
                <!-- Policies -->
                <div>
                    <h3 class="text-yellow-600 font-semibold mb-3">Policies</h3>
                    <ul class="space-y-2">
                        <li><a href="#" class="text-white hover:text-yellow-400">Return & Refund Policy</a></li>
                        <li><a href="#" class="text-white hover:text-yellow-400">Privacy & Sharing</a></li>
                    </ul>
                </div>
                <!-- Company -->
                <div>
                    <h3 class="text-yellow-600 font-semibold mb-3">Company</h3>
                    <ul class="space-y-2">
                        <li><a href="{{ url_for('index') }}" class="text-white hover:text-yellow-400">About Us</a></li>
                        <li><a href="{{ url_for('index') }}" class="text-white hover:text-yellow-400">Contact Us</a></li>
                        <li><a href="{{ url_for('login') }}" class="text-white hover:text-yellow-400">Admin</a></li>
                        <li class="mt-4 text-white font-medium">+254701539003</li>
                        <li>vickiebmochama@gmail.com</li>
                        <li class="flex gap-4 mt-2 text-xl">
                            <a href="#"><i class="fab fa-pinterest"></i></a>
                            <a href="#"><i class="fab fa-facebook"></i></a>
                            <a href="#"><i class="fab fa-instagram"></i></a>
                            <a href="#"><i class="fab fa-youtube"></i></a>
                            <a href="#"><i class="fab fa-whatsapp"></i></a>
                        </li>
                    </ul>
                </div>
                <!-- Subscribe -->
                <div>
                    <h3 class="text-yellow-600 font-semibold mb-3">Let’s Get in Touch</h3>
                    <p class="text-sm mb-3">Sign up to subscribe and receive 5% off your artifact order</p>
                    <form class="flex items-center border rounded-md overflow-hidden bg-white text-black">
                        <input type="email" placeholder="Enter your email" class="px-3 py-2 w-full focus:outline-none">
                        <button type="submit" class="px-3 py-2 text-white bg-yellow-600 hover:bg-yellow-700 transition"><i class="fas fa-arrow-right"></i></button>
                    </form>
                    <div class="mt-2 flex items-start gap-2">
                        <input type="checkbox" class="mt-1">
                        <p class="text-xs">I agree with the <a href="#" class="underline">Terms & Conditions</a></p>
                    </div>
                </div>
            </div>
            <!-- Mobile Dropdowns -->
            <div class="md:hidden space-y-4">
                <!-- Shop -->
                <details class="bg-gray-900 rounded-md p-4">
                    <summary class="text-yellow-500 font-semibold cursor-pointer">Shop</summary>
                    <ul class="grid grid-cols-2 gap-x-4 gap-y-2 mt-3 text-sm">
                        <li><a href="{{ url_for('our_products') }}" class="text-white hover:text-yellow-400">Artifact Collections</a></li>
                        <li><a href="{{ url_for('account') }}" class="text-white hover:text-yellow-400">Track My Order</a></li>
                    </ul>
                </details>
                <!-- Sell -->
                <details class="bg-gray-900 rounded-md p-4">
                    <summary class="text-yellow-500 font-semibold cursor-pointer">Sell</summary>
                    <ul class="grid grid-cols-2 gap-x-4 gap-y-2 mt-3 text-sm">
                        <li><a href="#" class="text-white hover:text-yellow-400">Sell on Zira Artifacts</a></li>
                        <li><a href="#" class="text-white hover:text-yellow-400">Artisan Seller FAQ</a></li>
                    </ul>
                </details>
                <!-- Policies -->
                <details class="bg-gray-900 rounded-md p-4">
                    <summary class="text-yellow-500 font-semibold cursor-pointer">Policies</summary>
                    <ul class="grid grid-cols-2 gap-x-4 gap-y-2 mt-3 text-sm">
                        <li><a href="#" class="text-white hover:text-yellow-400">Return & Refund Policy</a></li>
                        <li><a href="#" class="text-white hover:text-yellow-400">Privacy & Sharing</a></li>
                    </ul>
                </details>
                <!-- Company -->
                <details class="bg-gray-900 rounded-md p-4">
                    <summary class="text-yellow-500 font-semibold cursor-pointer">Company</summary>
                    <ul class="grid grid-cols-2 gap-x-4 gap-y-2 mt-3 text-sm">
                        <li><a href="{{ url_for('index') }}" class="text-white hover:text-yellow-400">About Us</a></li>
                        <li><a href="{{ url_for('index') }}" class="text-white hover:text-yellow-400">Contact Us</a></li>
                        <li><a href="{{ url_for('login') }}" class="text-white hover:text-yellow-400">Admin</a></li>
                    </ul>
                    <div class="mt-3 text-sm">
                        <p>+254701539003</p>
                        <p>vickiebmochama@gmail.com</p>
                        <div class="flex gap-3 mt-2 text-xl">
                            <a href="#"><i class="fab fa-pinterest"></i></a>
                            <a href="#"><i class="fab fa-facebook"></i></a>
                            <a href="#"><i class="fab fa-instagram"></i></a>
                            <a href="#"><i class="fab fa-youtube"></i></a>
                            <a href="#"><i class="fab fa-whatsapp"></i></a>
                        </div>
                    </div>
                </details>
                <!-- Subscribe -->
                <details class="bg-gray-900 rounded-md p-4">
                    <summary class="text-yellow-500 font-semibold cursor-pointer">Let’s Get in Touch</summary>
                    <p class="text-sm mt-2">Sign up to subscribe and receive 5% off your artifact order</p>
                    <form class="flex items-center border rounded-md overflow-hidden bg-white text-black mt-2">
                        <input type="email" placeholder="Enter your email" class="px-3 py-2 w-full focus:outline-none">
                        <button type="submit" class="px-3 py-2 text-white bg-yellow-600 hover:bg-yellow-700 transition"><i class="fas fa-arrow-right"></i></button>
                    </form>
                    <div class="mt-2 flex items-start gap-2">
                        <input type="checkbox" class="mt-1">
                        <p class="text-xs">I agree with the <a href="#" class="underline">Terms & Conditions</a></p>
                    </div>
                </details>
            </div>
        </div>
    </footer>

    <!-- JavaScript -->
 <script>
    // Currency Conversion Logic (KES as base currency)
const exchangeRates = {
    USD: 0.0077, // 1 KES = 0.0077 USD
    EUR: 0.0073, // 1 KES = 0.0073 EUR
    GBP: 0.0061, // 1 KES = 0.0061 GBP
    KES: 1       // 1 KES = 1 KES
};
let currentCurrency = '{{ current_currency }}';

// Toggle Currency Dropdown (Mobile and Desktop)
function toggleCurrencyDropdown(buttonId, dropdownId) {
    return function (e) {
        e.preventDefault();
        e.stopPropagation();
        const dropdown = document.getElementById(dropdownId);
        if (dropdown) {
            dropdown.classList.toggle('hidden');
            console.log(`${dropdownId} toggled:`, !dropdown.classList.contains('hidden'), 'Screen width:', window.innerWidth);
        } else {
            console.error(`${dropdownId} element not found`);
        }
    };
}

// Attach event listeners to both currency buttons
const mobileCurrencyButton = document.getElementById('mobile-country-btn');
const desktopCurrencyButton = document.getElementById('desktop-country-btn');

if (mobileCurrencyButton) {
    mobileCurrencyButton.addEventListener('click', toggleCurrencyDropdown('mobile-country-btn', 'mobile-country-dropdown'));
} else {
    console.error('Mobile currency button not found');
}

if (desktopCurrencyButton) {
    desktopCurrencyButton.addEventListener('click', toggleCurrencyDropdown('desktop-country-btn', 'desktop-country-dropdown'));
} else {
    console.error('Desktop currency button not found');
}

// Close dropdowns when clicking outside
document.addEventListener('click', (e) => {
    const dropdowns = [
        { id: 'mobile-country-dropdown', buttonId: 'mobile-country-btn' },
        { id: 'desktop-country-dropdown', buttonId: 'desktop-country-btn' }
    ];
    dropdowns.forEach(({ id, buttonId }) => {
        const dropdown = document.getElementById(id);
        const button = document.getElementById(buttonId);
        if (dropdown && button && !dropdown.contains(e.target) && !button.contains(e.target)) {
            if (!dropdown.classList.contains('hidden')) {
                dropdown.classList.add('hidden');
                console.log(`${id} closed (outside click)`, 'Screen width:', window.innerWidth);
            }
        }
    });
});

// Update Currency
document.querySelectorAll('.country-option').forEach(option => {
    option.addEventListener('click', (e) => {
        e.preventDefault();
        const country = e.target.getAttribute('data-country');
        const flag = e.target.getAttribute('data-flag');
        currentCurrency = e.target.getAttribute('data-currency');
        // Update both buttons
        const buttons = [document.getElementById('mobile-country-btn'), document.getElementById('desktop-country-btn')];
        buttons.forEach(button => {
            if (button) {
                button.innerHTML = `<span class="flag">${flag}</span> ${country}`;
            }
        });
        // Close both dropdowns
        ['mobile-country-dropdown', 'desktop-country-dropdown'].forEach(id => {
            const dropdown = document.getElementById(id);
            if (dropdown) {
                dropdown.classList.add('hidden');
            }
        });
        updatePrices();
        console.log('Currency updated to:', currentCurrency);
    });
});

// Update Prices
function updatePrices() {
    // Convert product prices from KES to selected currency
    document.querySelectorAll('.price').forEach(priceElement => {
        const basePriceKES = parseFloat(priceElement.getAttribute('data-price'));
        const convertedPrice = (basePriceKES * exchangeRates[currentCurrency]).toFixed(2);
        priceElement.textContent = `${currentCurrency} ${convertedPrice}`;
    });
    document.querySelectorAll('.discounted-price').forEach(priceElement => {
        const baseDiscountedPriceKES = parseFloat(priceElement.getAttribute('data-discounted-price'));
        const convertedPrice = (baseDiscountedPriceKES * exchangeRates[currentCurrency]).toFixed(2);
        priceElement.textContent = `${currentCurrency} ${convertedPrice}`;
    });

    // Update Price Filter Options (convert KES ranges to selected currency)
    const priceFilter = document.querySelector('.price-filter');
    const selectedValue = priceFilter.value;
    const rangeLow = 13000; // Approx 100 USD in KES (100 / 0.0077)
    const rangeHigh = 26000; // Approx 200 USD in KES (200 / 0.0077)
    priceFilter.innerHTML = `
        <option value="all">All Prices</option>
        <option value="0-${rangeLow}">${currentCurrency} 0 - ${(rangeLow * exchangeRates[currentCurrency]).toFixed(2)}</option>
        <option value="${rangeLow}-${rangeHigh}">${currentCurrency} ${(rangeLow * exchangeRates[currentCurrency]).toFixed(2)} - ${(rangeHigh * exchangeRates[currentCurrency]).toFixed(2)}</option>
        <option value="${rangeHigh}+">${currentCurrency} ${(rangeHigh * exchangeRates[currentCurrency]).toFixed(2)}+</option>
    `;
    priceFilter.value = selectedValue;
}

// Filter Logic
let selectedCategory = 'all';
let selectedPriceRange = 'all';
let searchQuery = '';

const applyFilters = () => {
    let visibleProducts = 0;
    document.querySelectorAll('.product-card').forEach(card => {
        // Category Filter
        const categoryMatch = selectedCategory === 'all' || card.getAttribute('data-category') === selectedCategory;
        // Price Filter (compare in KES)
        const priceKES = parseFloat(card.querySelector('.price').getAttribute('data-price'));
        let priceMatch = true;
        if (selectedPriceRange === '0-13000') {
            priceMatch = priceKES <= 13000;
        } else if (selectedPriceRange === '13000-26000') {
            priceMatch = priceKES > 13000 && priceKES <= 26000;
        } else if (selectedPriceRange === '26000+') {
            priceMatch = priceKES > 26000;
        }
        // Search Filter
        const name = card.getAttribute('data-name').toLowerCase();
        const category = card.getAttribute('data-category').toLowerCase();
        const searchMatch = !searchQuery || name.includes(searchQuery) || category.includes(searchQuery);

        // Combined Filter
        if (categoryMatch && priceMatch && searchMatch) {
            card.style.display = 'block';
            visibleProducts++;
        } else {
            card.style.display = 'none';
        }
    });

    // Toggle No Results Messages
    const noProducts = document.querySelector('.no-results:not(#no-search-results)');
    const noSearchResults = document.getElementById('no-search-results');
    if (visibleProducts === 0) {
        if (searchQuery) {
            noSearchResults.style.display = 'block';
            if (noProducts) noProducts.style.display = 'none';
        } else {
            noSearchResults.style.display = 'none';
            if (noProducts) noProducts.style.display = 'block';
        }
    } else {
        noSearchResults.style.display = 'none';
        if (noProducts) noProducts.style.display = 'none';
    }
};

// Live Search
document.querySelectorAll('.search-input').forEach(input => {
    input.addEventListener('input', (e) => {
        searchQuery = e.target.value.trim().toLowerCase();
        applyFilters();
    });
});

// Category Filter
document.querySelectorAll('.filter-item').forEach(item => {
    item.addEventListener('click', (e) => {
        e.preventDefault();
        selectedCategory = e.target.getAttribute('data-filter');
        document.querySelectorAll('.filter-item').forEach(i => i.classList.remove('font-bold', 'text-yellow-600'));
        e.target.classList.add('font-bold', 'text-yellow-600');
        applyFilters();
    });
});

// Price Range Filter
document.querySelector('.price-filter').addEventListener('change', (e) => {
    selectedPriceRange = e.target.value;
    applyFilters();
});

// Display Options
document.querySelectorAll('.display-option').forEach(option => {
    option.addEventListener('click', (e) => {
        document.querySelectorAll('.display-option').forEach(opt => opt.classList.remove('active'));
        e.target.classList.add('active');

        const grid = document.querySelector('.product-grid');
        grid.classList.remove('cols-2', 'cols-3', 'cols-4', 'cols-5', 'list-view');

        if (e.target.classList.contains('list-view')) {
            grid.classList.add('list-view');
        } else {
            const cols = e.target.getAttribute('data-cols');
            grid.classList.add(`cols-${cols}`);
        }
    });
});

// Wishlist Button Toggle
document.querySelectorAll('.wishlist-btn').forEach(btn => {
    btn.addEventListener('click', () => {
        btn.classList.toggle('active');
        const icon = btn.querySelector('i');
        icon.classList.toggle('fas');
        icon.classList.toggle('far');
    });
});

// Add to Wishlist
function addToWishlist(productId) {
    const productCard = document.querySelector(`.product-card[data-product-id="${productId}"]`) || 
                       document.querySelector(`[data-product-id="${productId}"]`);
    const wishlistBtn = productCard ? productCard.querySelector('.wishlist-btn') : document.querySelector(`.wishlist-btn[onclick*="addToWishlist(${productId})"]`);
    const icon = wishlistBtn.querySelector('i');
    const tooltip = wishlistBtn.querySelector('.tooltip');
    const isActive = wishlistBtn.classList.contains('active');
    const method = isActive ? 'DELETE' : 'POST';
    const url = isActive ? `/api/wishlist/${productId}` : '/api/wishlist';

    fetch(url, {
        method: method,
        headers: {
            'Content-Type': 'application/json',
        },
        body: method === 'POST' ? JSON.stringify({ product_id: productId }) : null,
        credentials: 'include'
    })
    .then(response => {
        if (response.status === 401) {
            Toastify({
                text: "Please login to add any item to your wishlist.",
                duration: 3000,
                close: true,
                gravity: "top",
                position: "right",
                backgroundColor: "#f87171",
                stopOnFocus: true
            }).showToast();
            setTimeout(() => {
                window.location.href = '/user_login';
            }, 3000);
            return null;
        }
        if (!response.ok) {
            throw new Error(`Failed to update wishlist: ${response.statusText}`);
        }
        return response.json();
    })
    .then(data => {
        if (data) {
            Toastify({
                text: data.message,
                duration: 3000,
                close: true,
                gravity: "top",
                position: "right",
                backgroundColor: "#4ade80",
                stopOnFocus: true
            }).showToast();
            wishlistBtn.classList.toggle('active');
            icon.classList.toggle('fas');
            icon.classList.toggle('far');
            tooltip.textContent = wishlistBtn.classList.contains('active') ? 'Remove from Wishlist' : 'Add to Wishlist';
        }
    })
    .catch(error => {
        if (error.message !== 'Failed to update wishlist: Unauthorized') {
            console.error('Error managing wishlist:', error);
            Toastify({
                text: 'Failed to update wishlist: ' + error.message,
                duration: 4000,
                close: true,
                gravity: "top",
                position: "right",
                backgroundColor: "#f87171",
                stopOnFocus: true
            }).showToast();
        }
    });
}

// Add to Cart with Quantity Popup
function addToCart(productId) {
    const modal = document.getElementById('quantity-modal');
    const quantityInput = document.getElementById('quantity-input');
    const confirmButton = document.getElementById('confirm-quantity');
    const cancelButton = document.getElementById('cancel-quantity');

    quantityInput.value = 1;
    modal.classList.remove('hidden');

    const confirmHandler = () => {
        const quantity = parseInt(quantityInput.value);
        if (isNaN(quantity) || quantity < 1) {
            Toastify({
                text: "Please enter a valid quantity (1 or more).",
                duration: 3000,
                close: true,
                gravity: "top",
                position: "right",
                backgroundColor: "#f87171",
                stopOnFocus: true
            }).showToast();
            return;
        }

        fetch('/api/cart', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ product_id: productId, quantity: quantity }),
            credentials: 'include'
        })
        .then(response => {
            if (response.status === 401 || (response.redirected && response.url.includes('/login'))) {
                Toastify({
                    text: response.status === 401 ? "Please login to add any item to your cart." : "Session expired. Please log in.",
                    duration: response.status === 401 ? 3000 : 4000,
                    close: true,
                    gravity: "top",
                    position: "right",
                    backgroundColor: "#f87171",
                    stopOnFocus: true
                }).showToast();
                modal.classList.add('hidden');
                setTimeout(() => {
                    window.location.href = '/user_login';
                }, response.status === 401 ? 3000 : 4000);
                return null;
            }
            if (!response.ok) {
                throw new Error(`Failed to add to cart: ${response.statusText}`);
            }
            return response.json();
        })
        .then(data => {
            if (data) {
                Toastify({
                    text: data.message,
                    duration: 3000,
                    close: true,
                    gravity: "top",
                    position: "right",
                    backgroundColor: "#4ade80",
                    stopOnFocus: true
                }).showToast();
                modal.classList.add('hidden');
            }
        })
        .catch(error => {
            if (error.message !== 'Failed to add to cart: Unauthorized') {
                console.error('Error adding to cart:', error);
                Toastify({
                    text: 'Failed to add to cart: ' + error.message,
                    duration: 4000,
                    close: true,
                    gravity: "top",
                    position: "right",
                    backgroundColor: "#f87171",
                    stopOnFocus: true
                }).showToast();
            }
        })
        .finally(() => {
            confirmButton.removeEventListener('click', confirmHandler);
            cancelButton.removeEventListener('click', cancelHandler);
        });
    };

    const cancelHandler = () => {
        modal.classList.add('hidden');
        confirmButton.removeEventListener('click', confirmHandler);
        cancelButton.removeEventListener('click', cancelHandler);
    };

    confirmButton.addEventListener('click', confirmHandler);
    cancelButton.addEventListener('click', cancelHandler);
}

// Mobile Navbar Toggle
document.getElementById('nav-toggler').addEventListener('click', () => {
    const sidebar = document.getElementById('mobile-sidebar');
    const icon = document.querySelector('#nav-toggler i');
    sidebar.classList.toggle('open'); // Toggle the 'open' class
    icon.classList.toggle('fa-bars');
    icon.classList.toggle('fa-times');
    icon.classList.add('animate-rotateToggle');
    setTimeout(() => icon.classList.remove('animate-rotateToggle'), 300);
});

// Close Mobile Sidebar
document.getElementById('close-sidebar').addEventListener('click', () => {
    const sidebar = document.getElementById('mobile-sidebar');
    const icon = document.querySelector('#nav-toggler i');
    sidebar.classList.remove('open'); // Remove 'open' class
    icon.classList.add('fa-bars');
    icon.classList.remove('fa-times');
    icon.classList.add('animate-rotateToggle');
    setTimeout(() => icon.classList.remove('animate-rotateToggle'), 300);
});

// Mobile Search Toggle
document.getElementById('mobile-search-icon').addEventListener('click', (e) => {
    e.stopPropagation(); // Prevent event bubbling
    const searchBar = document.getElementById('mobile-search-bar');
    if (searchBar) {
        searchBar.classList.toggle('active');
        searchBar.classList.toggle('hidden'); // Explicitly toggle hidden class
        const icon = document.getElementById('mobile-search-icon');
        icon.classList.add('animate-bounce');
        setTimeout(() => icon.classList.remove('animate-bounce'), 200);
        console.log('Mobile search bar toggled:', searchBar.classList.contains('active')); // Debugging
    } else {
        console.error('Mobile search bar element not found');
    }
});

// Filter Toggler Button (Mobile)
document.getElementById('filter-toggler').addEventListener('click', () => {
    const sidebar = document.querySelector('.sidebar');
    const button = document.getElementById('filter-toggler');
    sidebar.classList.toggle('open');
    button.classList.add('animate-pulse');
    setTimeout(() => button.classList.remove('animate-pulse'), 300);
});

// Filter Close Button (Mobile)
document.getElementById('filter-close-btn').addEventListener('click', () => {
    const sidebar = document.querySelector('.sidebar');
    const icon = document.querySelector('#filter-close-btn i');
    sidebar.classList.remove('open');
    icon.classList.add('animate-rotateToggle');
    setTimeout(() => icon.classList.remove('animate-rotateToggle'), 300);
    applyFilters();
});

// Close Filter Sidebar When Clicking Outside (Mobile)
document.addEventListener('click', (e) => {
    const sidebar = document.querySelector('.sidebar');
    const toggler = document.getElementById('filter-toggler');
    const closeBtn = document.getElementById('filter-close-btn');
    if (sidebar.classList.contains('open') && !sidebar.contains(e.target) && !toggler.contains(e.target) && !closeBtn.contains(e.target)) {
        sidebar.classList.remove('open');
        applyFilters();
    }
});

// Floating Button Positioning and Event Listeners
document.addEventListener('DOMContentLoaded', function() {
    // Adjust positions of floating buttons
    function adjustFloatingButtonPositions() {
        const floatingButtons = document.querySelectorAll('[style*="position: fixed"][style*="bottom"][style*="left"]');
        let aboutOffset = 16; // Default bottom for About Zira button

        // Calculate offsets for buttons excluding WhatsApp (right-aligned)
        floatingButtons.forEach(button => {
            if (button !== document.querySelector('.discount-btn-container') &&
                button !== document.querySelector('.whatsapp-btn-container')) {
                const buttonBottom = parseInt(getComputedStyle(button).bottom) || 0;
                const buttonHeight = button.offsetHeight || 48;
                aboutOffset = Math.max(aboutOffset, buttonBottom + buttonHeight + 16);
            }
        });

        // Set About Zira button position
        const aboutButton = document.querySelector('.discount-btn-container');
        if (aboutButton) {
            aboutButton.style.bottom = `${aboutOffset}px`;
        }
    }
    adjustFloatingButtonPositions();
    window.addEventListener('resize', adjustFloatingButtonPositions);

    // Discount Popup Toggle
    if (typeof jQuery !== 'undefined') {
        $(document).ready(function() {
            $('#discount-btn').off('click').on('click', function() {
                $('#discount-page').removeClass('-translate-x-full');
                console.log('Discount button clicked');
            });
            $('#close-discount').off('click').on('click', function() {
                $('#discount-page').addClass('-translate-x-full');
                console.log('Close discount clicked');
            });
        });
    } else {
        console.error('jQuery is not loaded');
    }

    // WhatsApp Button Click Handler
    const whatsappBtn = document.querySelector('.whatsapp-btn-container .floating-btn');
    if (whatsappBtn) {
        whatsappBtn.addEventListener('click', () => {
            const phoneNumber = '+254701539003';
            const message = 'Hello, I have a question about Zira Collection!';
            const whatsappUrl = `https://wa.me/${phoneNumber}?text=${encodeURIComponent(message)}`;
            window.open(whatsappUrl, '_blank');
            console.log('WhatsApp button clicked');
        });
    } else {
        console.error('WhatsApp button not found');
    }

    // Contact Form Submission
    const contactForm = document.getElementById('contact-form');
    if (contactForm) {
        contactForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            console.log('Form submitted');
            const formData = new FormData(e.target);
            const data = {
                subject: formData.get('subject'),
                message: formData.get('message'),
            };
            console.log('Form data:', data);

            const showFlashMessage = (text, isSuccess) => {
                console.log('Showing flash message:', text, isSuccess);
                const flashMessage = document.getElementById('flash-message1');
                if (flashMessage) {
                    flashMessage.textContent = text;
                    flashMessage.className = isSuccess ? 'success' : 'error';
                    flashMessage.style.display = 'block';
                    flashMessage.classList.add('show');
                    setTimeout(() => {
                        flashMessage.classList.remove('show');
                        setTimeout(() => {
                            flashMessage.style.display = 'none';
                        }, 500);
                    }, 5000);
                }
            };

            try {
                const response = await fetch('/api/send-email', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data),
                    credentials: 'include',
                });
                console.log('Response status:', response.status);
                const result = await response.json();
                console.log('Response data:', result);
                if (!response.ok) throw new Error(result.error || 'Failed to send message');
                showFlashMessage('Your message has been sent successfully! We will get back to you shortly', true);
                e.target.reset();
            } catch (error) {
                console.error('Error:', error.message);
                showFlashMessage(`Error: ${error.message}`, false);
            }
        });
    } else {
        console.error('Contact form not found');
    }

    // Keyboard Accessibility for Floating Buttons
    document.getElementById('discount-btn').addEventListener('keydown', (e) => {
        if (e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            $('#discount-page').removeClass('-translate-x-full');
        }
    });
    document.getElementById('close-discount').addEventListener('keydown', (e) => {
        if (e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            $('#discount-page').addClass('-translate-x-full');
        }
    });
    if (whatsappBtn) {
        whatsappBtn.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' || e.key === ' ') {
                e.preventDefault();
                const phoneNumber = '+254701539003';
                const message = 'Hello, I have a question about Zira Collection!';
                const whatsappUrl = `https://wa.me/${phoneNumber}?text=${encodeURIComponent(message)}`;
                window.open(whatsappUrl, '_blank');
            }
        });
    }
});

// Open Product Details Modal
function openProductModal(id, name, category, price, description, image) {
    const modal = document.getElementById('product-details-modal');
    const modalImage = document.getElementById('modal-image');
    const modalName = document.getElementById('modal-name');
    const modalCategory = document.getElementById('modal-category');
    const modalPrice = document.getElementById('modal-price');
    const modalDescription = document.getElementById('modal-description');
    const addToCartButton = document.getElementById('modal-add-to-cart');

    // Set modal content
    modalImage.src = image;
    modalImage.alt = name;
    modalName.textContent = name;
    modalCategory.textContent = `Category: ${category}`;
    modalPrice.textContent = `${currentCurrency} ${(price * exchangeRates[currentCurrency]).toFixed(2)}`;
    modalDescription.textContent = description || 'No description available.';

    // Show modal
    modal.classList.remove('hidden');

    // Add to Cart button handler
    addToCartButton.onclick = () => {
        modal.classList.add('hidden');
        addToCart(id);
    };
}

// Event Delegation for Product Clicks
document.getElementById('product-grid').addEventListener('click', (e) => {
    const target = e.target.closest('.product-image, .product-name');
    if (!target) return;

    // Prevent default behavior and stop propagation
    e.preventDefault();
    e.stopPropagation();

    // Find the parent product card
    const productCard = target.closest('.product-card');
    if (!productCard) return;

    // Extract product data from the product card
    const id = productCard.getAttribute('data-product-id');
    const name = productCard.getAttribute('data-name');
    const category = productCard.getAttribute('data-category');
    const price = parseFloat(productCard.querySelector('.price').getAttribute('data-price'));
    const description = productCard.getAttribute('data-description');
    const image = productCard.querySelector('img').src;

    // Open the modal with the extracted data
    openProductModal(id, name, category, price, description, image);
});

// Close Product Details Modal
document.getElementById('close-product-modal').addEventListener('click', (e) => {
    e.stopPropagation(); // Prevent click from bubbling to the modal container
    const modal = document.getElementById('product-details-modal');
    if (modal) {
        modal.classList.add('hidden');
        console.log('Close button clicked: Modal closed');
    } else {
        console.error('Modal element not found');
    }
}, { once: false }); // Ensure the listener is only added once

// Remove existing listeners to prevent duplicates
const closeButton = document.getElementById('close-product-modal');
if (closeButton) {
    // Clone the node to remove all existing listeners
    const newCloseButton = closeButton.cloneNode(true);
    closeButton.parentNode.replaceChild(newCloseButton, closeButton);

    // Add new listener
    newCloseButton.addEventListener('click', (e) => {
        e.stopPropagation();
        const modal = document.getElementById('product-details-modal');
        if (modal) {
            modal.classList.add('hidden');
            console.log('Close button clicked: Modal closed');
        } else {
            console.error('Modal element not found');
        }
    });
} else {
    console.error('Close button element not found');
}

// Close Modal on Outside Click
document.getElementById('product-details-modal').addEventListener('click', (e) => {
    const modal = document.getElementById('product-details-modal');
    if (e.target === modal) {
        modal.classList.add('hidden');
        console.log('Outside modal clicked: Modal closed');
    }
});

// Keyboard Accessibility for Modal Close
document.getElementById('close-product-modal').addEventListener('keydown', (e) => {
    if (e.key === 'Enter' || e.key === ' ') {
        e.preventDefault();
        document.getElementById('product-details-modal').classList.add('hidden');
    }
});

// Initialize Prices and Filters
updatePrices();
applyFilters();
 </script>
 <script src="{{ url_for('static', filename='js/email.js') }}"></script>
</body>
</html>